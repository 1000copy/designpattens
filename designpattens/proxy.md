一个类代表另一个类的功能，那么此类就是代理类。通常代理类和被代理类都实现一个接口，在使用此接口的场景下，代理类可以替代被代理类，以便达到缓存、保护、代理远程对象等任务。

代理模式UML图是这样的：

![](https://user-gold-cdn.xitu.io/2018/1/22/1611cad242e655b8?w=446&h=258&f=png&s=2989)

当访问Proxy，做一个请求操作时，Proxy会转发此操作到真实的类。但是也可能不转发。或者转发操作之前验证条件，这就要看代理的特性了。为了访问控制目的存在的代理，会验证权限或者前置条件，符合条件后放行；对于缓存目的的代理，当发现被代理对象已经加载就可以不必重新加载，而是使用已经存在的缓存对象了。

![](https://user-gold-cdn.xitu.io/2018/1/22/1611cadd8bb015ee?w=576&h=283&f=png&s=2592)

接下里的案例，实现缓存代理类。我们创建一个Image接口，和两个实现此接口的类，其中一个是真是的图片，RealImage，另外一个是代理图片ProxyImage，一旦RealImage装入后，访问的就是ProxyImage，此类直接代理RealImage，不再从文件中加载图片：

![](https://user-gold-cdn.xitu.io/2018/1/2/160b62cb99aa7cf0?w=560&h=263&f=jpeg&s=16191)

这个模式和Adapter有点像，不同的是接口的数量：Adapter是只有一个接口，代理类和被代理类共同实现一个接口，而Adapter模式则是一个类实现一个接口，在暴露一个接口。